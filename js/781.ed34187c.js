"use strict";(self["webpackChunknodecourse"]=self["webpackChunknodecourse"]||[]).push([[781],{1885:function(e,t,s){s.d(t,{Ac:function(){return d},HS:function(){return u},K$:function(){return $},MH:function(){return l},OJ:function(){return w},T8:function(){return _},TV:function(){return i},TY:function(){return c},f1:function(){return y},fN:function(){return f},fj:function(){return k},ht:function(){return I},lC:function(){return g},mh:function(){return h},pY:function(){return r},tO:function(){return p},td:function(){return b},zB:function(){return m},zk:function(){return v}});var n=s(6265),a=s.n(n);const o="https://warm-ridge-65785.herokuapp.com",r=e=>a().post(`${o}/user/sign_up`,e),i=e=>a().post(`${o}/user/sign_in`,e),u=e=>a().post(`${o}/user/updatePassword`,e),c=()=>a().get(`${o}/user/profile`),l=e=>a().patch(`${o}/user/profile`,e),m=()=>a().get(`${o}/user/getLikeList`),g=e=>a().post(`${o}/user/${e}/follow`),d=e=>a()["delete"](`${o}/user/${e}/follow`),p=()=>a().get(`${o}/user/getFollowingList`),f=e=>a().get(`${o}/posts`,{params:e}),h=(e,t)=>a().get(`${o}/posts/user/${t}`,{params:e}),$=e=>a().get(`${o}/post/${e}`),b=e=>a().post(`${o}/post`,e),k=e=>a()["delete"](`${o}/post/${e}`),v=e=>a().post(`${o}/post/${e}/like`),w=e=>a()["delete"](`${o}/post/${e}/like`),y=(e,t)=>a().post(`${o}/post/${t}/comment`,e),_=e=>a()["delete"](`${o}/post/${e}/comment`),I=(e,t)=>a().post(`${o}/upload?type=${t}`,e)},7484:function(e,t,s){var n=s(3766),a=s(1885),o=s(6294);const r=(0,o.Z)();t["Z"]=(0,n.Q_)("postStore",{state:()=>({tempImage:{msg:"",url:""}}),actions:{async upload(e,t=""){r.isLoading=!0,await(0,a.ht)(e,t).then((e=>{this.tempImage={msg:"",url:e.data.data},r.isLoading=!1})).catch((e=>{this.tempImage={msg:e.response?.data?.message||"上傳圖片失敗",url:""},r.isLoading=!1}))},async createLike(e){await(0,a.zk)(e).then((()=>{r.pushMessage({style:"dark",content:"已按讚"})})).catch((e=>{r.pushMessage({style:"danger",content:e.response?.data?.message||"按讚失敗"})}))},async delLike(e){await(0,a.OJ)(e).then((()=>{r.pushMessage({style:"dark",content:"取消按讚成功"})})).catch((e=>{r.pushMessage({style:"danger",content:e.response?.data?.message||"取消按讚失敗"})}))}}})},3781:function(e,t,s){s.r(t),s.d(t,{default:function(){return I}});var n=s(3396),a=s(7139),o=s(9242);const r=e=>((0,n.dD)("data-v-8298cc0c"),e=e(),(0,n.Cn)(),e),i=r((()=>(0,n._)("h1",{class:"header"},"張貼動態",-1))),u={class:"mb-4"},c=r((()=>(0,n._)("label",{for:"content",class:"form-label"},"貼文內容",-1))),l=r((()=>(0,n._)("label",{for:"image",class:"rounded-1"},"上傳圖片",-1))),m={class:"ms-4 text-danger"},g=r((()=>(0,n._)("i",{class:"bi bi-x-lg"},null,-1))),d=[g],p={class:"text-center"},f=["disabled"];function h(e,t,s,r,g,h){const $=(0,n.up)("VField"),b=(0,n.up)("error-message"),k=(0,n.up)("VForm");return(0,n.wg)(),(0,n.iD)(n.HY,null,[i,(0,n.Wm)(k,{class:"card p-md-8",id:"form",onSubmit:h.createPost,ref:"postForm"},{default:(0,n.w5)((({errors:e,meta:s})=>[(0,n._)("div",u,[c,(0,n.Wm)($,{type:"text",id:"content",placeholder:"輸入您的貼文內容",name:"貼文內容",class:(0,a.C_)(["form-control",{"is-invalid":e["貼文內容"]}]),rows:"5",rules:"required|max:200",modelValue:g.tempPost.content,"onUpdate:modelValue":t[0]||(t[0]=e=>g.tempPost.content=e),as:"textarea"},null,8,["class","modelValue"]),(0,n.Wm)(b,{name:"貼文內容",class:"invalid-feedback text-danger"})]),(0,n._)("div",{class:(0,a.C_)(["fileBtn mb-4",{"mb-8":""==g.tempPost.image}])},[l,(0,n._)("input",{type:"file",accept:"image/*",id:"image",name:"image",onChange:t[1]||(t[1]=(...e)=>h.uploadImage&&h.uploadImage(...e))},null,32),(0,n._)("small",m,(0,a.zw)(g.imageMsg),1)],2),g.tempPost.image?((0,n.wg)(),(0,n.iD)("div",{key:0,class:"bgCover position-relative mb-8",style:(0,a.j5)({backgroundImage:"url("+g.tempPost.image+")"})},[(0,n._)("a",{href:"#",class:"cardCloseBtn",onClick:t[2]||(t[2]=(0,o.iM)(((...e)=>h.resetImage&&h.resetImage(...e)),["prevent"]))},d)],4)):(0,n.kq)("",!0),(0,n._)("div",p,[(0,n._)("button",{type:"submit",class:"effectBtn btn btn-primary w-100",disabled:!s.valid}," 送出貼文 ",8,f)])])),_:1},8,["onSubmit"])],64)}var $=s(3766),b=s(6294),k=s(7484),v=s(1885),w={name:"CreatePostView",data(){return{imageMsg:"",tempPost:{content:"",image:""}}},methods:{createPost(){this.toggleLoading(!0),(0,v.td)(this.tempPost).then((()=>{this.toggleLoading(!1),this.pushMessage({style:"dark",content:"已建立貼文"}),this.$router.push("/")})).catch((e=>{this.toggleLoading(!1),this.pushMessage({style:"danger",content:e.response?.data?.message||"建立貼文失敗"})}))},async uploadImage(){const e=new FormData(document.getElementById("form"));await this.upload(e),this.tempPost.image=this.tempImage.url,this.imageMsg=this.tempImage.msg},resetImage(){document.getElementById("image").value="",this.tempPost.image="",this.imageMsg=""},...(0,$.nv)(b.Z,["toggleLoading","pushMessage"]),...(0,$.nv)(k.Z,["upload"])},computed:{...(0,$.rn)(k.Z,["tempImage"])}},y=s(89);const _=(0,y.Z)(w,[["render",h],["__scopeId","data-v-8298cc0c"]]);var I=_}}]);
//# sourceMappingURL=781.ed34187c.js.map